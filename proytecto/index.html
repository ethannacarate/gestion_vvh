<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gesti√≥n de Instrumental - Liceo</title>
    <link rel="stylesheet" href="static/css/styles.css">
</head>
<body>

    <div id="login-view" class="view-login">
        <div class="login-box">
            <h1>Bienvenido al Sistema</h1>
            <h2>Iniciar Sesi√≥n</h2>
            
            <div class="input-group">
                <label for="login-email">üìß Correo Electr√≥nico:</label>
                <input type="email" id="login-email" placeholder="ejemplo@liceo.edu" required>
            </div>

            <div class="input-group">
                <label for="login-password">üîí Contrase√±a:</label>
                <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
            </div>
            
            <p id="login-error-message" class="error-message hidden">Credenciales inv√°lidas.</p>

            <button onclick="handleLogin()">‚û°Ô∏è Acceder</button>
            
            <p class="role-hint">El correo define tu rol (Director, Docente, etc.)</p>
        </div>
    </div>

    <div id="main-app-view" class="view-app hidden">
        <header>
            <div class="header-content">
                <h1>Gesti√≥n de Instrumental | Rol: <span id="current-role-display"></span></h1>
                <button id="logout-button" onclick="logout()">Cerrar Sesi√≥n</button>
            </div>
        </header>

        <main class="container">
            
            <section id="add-product-section" class="card hidden">
                <h2>‚ûï Agregar Nuevo Instrumento</h2>
                <div class="input-group">
                    <label for="newCodigo">C√≥digo de Barras (Escaneado):</label>
                    <input type="text" id="newCodigo" readonly>
                </div>
                <div class="input-group">
                    <label for="newNombre">Nombre del Instrumento:</label>
                    <input type="text" id="newNombre" placeholder="Ej: Microscopio √ìptico #3">
                </div>
                <button onclick="registrarNuevoInstrumento()">‚úÖ Guardar Instrumento</button>
            </section>

            <section id="loan-return-section" class="card">
                <h2>üîç Pr√©stamo / Devoluci√≥n</h2>
                
                <div class="input-group">
                    <label for="codigoInstrumento">1¬∞ C√≥digo de Instrumento:</label>
                    <input type="text" id="codigoInstrumento" placeholder="Escanear Instrumento..." autofocus onchange="handleInstrumentScan(this.value)">
                </div>
                
                <div class="data-preview data-instrument">
                    <h3>Instrumento: <span id="nombreInstrumento">---</span></h3>
                    <p>Estado Actual: <span id="estadoInstrumento">---</span></p>
                </div>

                <div id="loan-form" class="hidden">
                    <div class="input-group">
                        <label for="codigoPersona">2¬∞ Pasaporte Escolar/C√©dula:</label>
                        <input type="text" id="codigoPersona" placeholder="Escanear Pasaporte/C√©dula..." onchange="handlePersonScan(this.value)">
                    </div>

                    <div class="data-preview data-person">
                        <h3>Persona: <span id="nombrePersona">---</span></h3>
                        <p>Rol: <span id="rolPersona">---</span></p>
                    </div>

                    <div class="control-group">
                        <div class="input-group quantity-control">
                            <label for="cantidad">Cantidad:</label>
                            <input type="number" id="cantidad" value="1" min="1">
                        </div>
                        
                        <div class="input-group checkbox-group">
                            <input type="checkbox" id="autorizadoDocente">
                            <label for="autorizadoDocente">Autorizado por el Docente</label>
                        </div>

                        <div class="input-group checkbox-group">
                            <input type="checkbox" id="prestamoLargoPlazo">
                            <label for="prestamoLargoPlazo">Pr√©stamo Largo Plazo (Director)</label>
                        </div>
                    </div>
                    
                    <button id="registrarBtn" onclick="registrarPrestamo()">üíæ Registrar Pr√©stamo</button>
                </div>

                <div id="return-button-container" class="hidden">
                    <p class="status-return">Instrumento **OCUPADO** por <span id="loaned-by"></span>.</p>
                    <button onclick="confirmarDevolucion()">‚Ü©Ô∏è Confirmar Devoluci√≥n</button>
                </div>

            </section>

            <section class="status-area">
                <h2>‚úÖ Estado de la Operaci√≥n</h2>
                <p id="statusMessage">Esperando operaci√≥n...</p>
            </section>

            <section id="register-history" class="card">
                <h2>üìã Historial de Pr√©stamos</h2>
                <div class="table-responsive">
                    <table id="history-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Instrumento</th>
                                <th>Persona</th>
                                <th>Cant.</th>
                                <th>Auth Doc.</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

        </main>

        <footer>
            <p>&copy; 2025 Proyecto Liceo | Sistema de Gesti√≥n.</p>
        </footer>
    </div>

    <script src="static/js/script.js"></script>
</body>
</html>